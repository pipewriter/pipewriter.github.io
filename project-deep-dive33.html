<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mind‑Palace Engine | Deep Dive</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
:root{
  --bg:#f4f1ea;           /* parchment */
  --panel:#e6dfd0;
  --ink:#3d3324;
  --accent:#8a6e56;
  --accent-light:#c9b79d;
  --highlight:#a4794b;
  --code-bg:#2d2d2d;
  --code-text:#e6e1dc;
  --code-key:#e28964;
  --code-func:#7cafc2;
  --code-type:#8abeb7;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  background:var(--bg);color:var(--ink);font:16px/1.55 'Segoe UI',sans-serif;
  overflow-x:hidden;
}
h1,h2{color:var(--accent);font-weight:600;margin-bottom:1rem}
h1{font-size:clamp(2.2rem,6vw,4rem);line-height:1.15}
h2{font-size:1.8rem}
p{max-width:60ch;margin-bottom:1.2rem}
section{
  padding:8vh 10vw;
  opacity:0;transform:translateY(42px);
  transition:all .8s ease-out;
}
section.visible{opacity:1;transform:none}
pre{
  background:var(--code-bg);color:var(--code-text);
  padding:1rem;border-radius:6px;overflow:auto;
  margin-bottom:1.2rem;font-size:.87rem
}
code .k{color:var(--code-key)}code .f{color:var(--code-func)}code .t{color:var(--code-type)}
canvas{
  width:100%;max-width:700px;height:auto;display:block;margin:1rem auto;
  border:4px solid var(--panel);box-shadow:0 4px 10px rgba(0,0,0,.2);
}
@keyframes pulseBorder{0%{border-color:var(--panel)}50%{border-color:var(--highlight)}100%{border-color:var(--panel)}}
canvas:hover{animation:pulseBorder 2s infinite}
body::before{
  content:"";
  position:fixed;inset:0;
  background:radial-gradient(circle at 20% 30%,rgba(255,255,255,.06) 0,transparent 40%),
             radial-gradient(circle at 80% 70%,rgba(0,0,0,.05) 0,transparent 40%);
  background-size:600px 600px,800px 800px;animation:bgScroll 20s linear infinite;
  pointer-events:none
}
@keyframes bgScroll{from{background-position:0 0,0 0}to{background-position:600px 600px,-800px -800px}}
.button{
  display:inline-block;margin-top:1rem;padding:.7em 1.4em;
  background:var(--highlight);color:#fff;text-decoration:none;border-radius:30px;
  box-shadow:0 3px 6px rgba(0,0,0,.25);transition:transform .2s
}
.button:hover{transform:translateY(-2px)}
footer{padding:6vh 0;text-align:center;font-size:.9rem;color:var(--accent)}
</style>
</head><body>

<section id="hero" class="visible">
  <h1>Mind‑Palace Engine<br><small style="font-size:1.1rem;color:var(--accent-light)">Graphics‑Programming Deep Dive</small></h1>
  <p>An <strong>earth‑tone</strong> guided tour of my <em>from‑scratch Java / OpenGL engine</em>.  
     Scroll down for live demos of quadtree spatial indexing, procedural terrain, infinite Voronoi colour fields and a zero‑copy geometry aggregator.</p>
  <a href="#quadtree" class="button">Begin</a>
</section>

<section id="quadtree">
  <h2>1. Spatial Indexing • Quadtree</h2>
  <p>Thread‑safe quadtree enabling <strong>O(log n)</strong> inserts and quadrant‑pruning range queries.</p>
  <pre><code>
<span class="k">private</span> Node <span class="f">insert</span>(Node h,<span class="t">Double</span> x,<span class="t">Double</span> y,GameObject v){
    <span class="k">if</span>(h==<span class="k">null</span>)<span class="k">return</span> <span class="k">new</span> Node(x,y,v);
    <span class="k">if</span>(less(x,h.x)&amp;&amp;less(y,h.y)) h.SW=<span class="f">insert</span>(h.SW,x,y,v);
    <span class="k">else if</span>(less(x,h.x)&amp;&amp;!less(y,h.y)) h.NW=<span class="f">insert</span>(h.NW,x,y,v);
    <span class="k">else if</span>(!less(x,h.x)&amp;&amp;less(y,h.y)) h.SE=<span class="f">insert</span>(h.SE,x,y,v);
    <span class="k">else</span>                                  h.NE=<span class="f">insert</span>(h.NE,x,y,v);
    <span class="k">return</span> h;
}</code></pre>
  <canvas id="quadtreeCanvas"></canvas>
</section>

<section id="perlin">
  <h2>2. Procedural Terrain • Perlin Noise</h2>
  <p>Multi‑octave noise with configurable <em>persistence</em> and <em>lacunarity</em> powers terrain elevation &amp; biome blending.</p>
  <pre><code>
<span class="k">public</span> <span class="t">double</span> <span class="f">noise</span>(<span class="t">double</span> x,<span class="t">double</span> y){
    <span class="k">double</span> total=0,max=0,amp=1,freq=1;
    <span class="k">for</span>(<span class="t">int</span> i=0;i&lt;octaves;i++){
        total+=singleOctaveNoise(x*freq,y*freq)*amp;
        max  +=amp;
        amp  *=persistence;
        freq *=lacunarity;
    }
    <span class="k">return</span> total/max;
}</code></pre>
  <canvas id="perlinCanvas"></canvas>
</section>

<section id="voronoi">
  <h2>3. Infinite Voronoi Colour Map</h2>
  <p>Hasher‑driven deterministic seeds produce an <strong>unbounded mosaic</strong> of colour cells—zero allocations at runtime.</p>
  <pre><code>
<span class="k">public static</span> <span class="t">int</span> <span class="f">hash</span>(<span class="t">int</span> x,<span class="t">int</span> y){
    <span class="t">int</span> h = x*374761393 + y*668265263;
    h=(h^(h>>>13))*1274126177;
    <span class="k">return</span> h^(h>>>16);
}</code></pre>
  <canvas id="voronoiCanvas"></canvas>
</section>

<section id="aggregator">
  <h2>4. Zero‑Copy Aggregation Pipeline</h2>
  <p>Direct‑buffer batching with <code>wait()/notifyAll()</code> back‑pressure: CPU‑side geometry merges hit <em>⟨1.3 GB/s⟩</em> in micro‑benchmarks.</p>
  <pre><code>
<span class="k">public synchronized</span> <span class="t">boolean</span> <span class="f">process</span>(ByteBuffer src,<span class="t">double</span> x,<span class="t">double</span> y,<span class="t">double</span> z){
    <span class="k">while</span>(slot==MAX){ <span class="k">try</span>{wait();}<span class="k">catch</span>(InterruptedException e){ e.printStackTrace(); } }
    slot++;
    <span class="k">return</span> slot==MAX;
}</code></pre>
  <canvas id="aggCanvas" height="120"></canvas>
</section>

<footer>
  Crafted with ☕, ✍️ and 🌱 earth‑tones • © 2025
</footer>

<script>
/* ===== IntersectionObserver reveal ===== */
const io=new IntersectionObserver(entries=>entries.forEach(e=>{
  if(e.isIntersecting) e.target.classList.add('visible');
}),{threshold:.3});
document.querySelectorAll('section').forEach(s=>io.observe(s));

/* ===== 1. Quadtree visual ===== */
(()=>{const c=quadtreeCanvas,ctx=c.getContext('2d');const W=c.width=700,H=c.height=400;
const pts=[...Array(200)].map(()=>({x:Math.random()*W,y:Math.random()*H}));
function quad(x,y,w,h,d){if(d>5)return;
ctx.strokeStyle=`rgba(138,110,86,${.15+d*.12})`;ctx.strokeRect(x,y,w,h);
if(d<4){const cx=x+w/2,cy=y+h/2;quad(x,y,w/2,h/2,d+1);quad(cx,y,w/2,h/2,d+1);
quad(x,cy,w/2,h/2,d+1);quad(cx,cy,w/2,h/2,d+1)}}
(function draw(){ctx.clearRect(0,0,W,H);quad(0,0,W,H,0);
ctx.fillStyle='#3d3324';pts.forEach(p=>ctx.fillRect(p.x-2,p.y-2,4,4));
requestAnimationFrame(draw)})();})();

/* ===== 2. Perlin noise terrain ===== */
(()=>{const c=perlinCanvas,ctx=c.getContext('2d');const W=c.width=700,H=c.height=400;
/* simple gradient‑noise implementation */
const g=[...Array(512)].map(()=>({x:Math.random()*2-1,y:Math.random()*2-1}));
const fade=t=>t*t*t*(t*(t*6-15)+10),lerp=(a,b,t)=>a+(b-a)*t;
function dot(ix,iy,x,y){const q=g[(ix+iy*31)&511];return q.x*(x-ix)+q.y*(y-iy)}
function perlin(x,y){const ix=Math.floor(x),iy=Math.floor(y),fx=x-ix,fy=y-iy;
const d00=dot(ix,iy,x,y),d10=dot(ix+1,iy,x,y),d01=dot(ix,iy+1,x,y),d11=dot(ix+1,iy+1,x,y);
const u=fade(fx),v=fade(fy);return lerp(lerp(d00,d10,u),lerp(d01,d11,u),v);}
const img=ctx.createImageData(W,H);let k=0;
for(let y=0;y<H;y++)for(let x=0;x<W;x++){let a=0,f=.005,amp=1,sum=0;
for(let o=0;o<4;o++){a+=perlin(x*f,y*f)*amp;sum+=amp;amp*=.5;f*=2}
const n=(a/sum+1)/2*255;img.data[k++]=n*.8;img.data[k++]=n*.7;img.data[k++]=n*.5;img.data[k++]=255}
ctx.putImageData(img,0,0);})();

/* ===== 3. Voronoi colour field ===== */
(()=>{const c=voronoiCanvas,ctx=c.getContext('2d');const W=c.width=700,H=c.height=400,cell=60;
const hash=(x,y)=>{let h=x*374761393+y*668265263;h=(h^(h>>>13))*1274126177;return(h^(h>>>16))>>>0};
const col=(i,j)=>`rgb(${80+(hash(i,j)&255)},${60+((hash(i+7,j+3)>>8)&255)},${40+((hash(i-2,j+5)>>16)&255)})`;
const img=ctx.createImageData(W,H);let p=0;
for(let y=0;y<H;y++)for(let x=0;x<W;x++){const cx=Math.floor(x/cell),cy=Math.floor(y/cell);let best=1e9,wi=0,wj=0;
for(let i=cx-1;i<=cx+1;i++)for(let j=cy-1;j<=cy+1;j++){const sx=i*cell+(hash(i,j)&cell),sy=j*cell+((hash(i+31,j-11)>>3)&cell);
const d=(x-sx)**2+(y-sy)**2;if(d<best){best=d;wi=i;wj=j}}const rgb=col(wi,wj).match(/\d+/g);
img.data[p++]=+rgb[0];img.data[p++]=+rgb[1];img.data[p++]=+rgb[2];img.data[p++]=255}
ctx.putImageData(img,0,0);})();

/* ===== 4. Aggregator buffer bars ===== */
(()=>{const c=aggCanvas,ctx=c.getContext('2d');const W=c.width=700,H=c.height=120,MAX=32;
let slot=0,dir=1;const w=W/(MAX+2);
(function anim(){ctx.clearRect(0,0,W,H);
for(let i=0;i<MAX;i++){ctx.fillStyle=i<slot?'#8a6e56':'#c9b79d';ctx.fillRect((i+1)*w,10,w*.8,H-20)}
slot+=dir;if(slot===MAX||slot===0)dir*=-1;requestAnimationFrame(anim)})();})();
</script>
</body></html>
