<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Engine From Scratch — Deep Dive</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<!-- ---------- THEME ---------- -->
<style>
:root{
    /* Earth‑tone palette chosen for maximum sophistication & WCAG AA contrast */
    --soil-90:#1e1b19;      /* near‑black walnut */
    --soil-80:#2c2825;
    --soil-70:#3d3732;
    --sand-40:#b79d74;
    --sand-20:#d9cba0;
    --sage-30:#4e6e5d;
    --cream-05:#f5f3ee;
    --rust-50:#8b5e3c;
    --rust-30:#a67c52;

    --text-main:var(--cream-05);
    --text-muted:#d2cbbf;
    --accent:var(--sand-20);
    --link:#e9d3a2;
    --shadow:0 .3rem 1rem rgba(0,0,0,.4);
    --radius:.6rem;
    --font-head:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    --font-body:Inter,Roboto,Helvetica,Arial,sans-serif;
}

/* ---------- GLOBAL ---------- */
html,body{margin:0;height:100%;background:var(--soil-80);color:var(--text-main);font-family:var(--font-body);scroll-behavior:smooth}
section{padding:6rem clamp(1rem,5vw,6rem);position:relative;isolation:isolate}
h1,h2,h3{font-family:var(--font-head);margin:.2em 0;color:var(--accent);letter-spacing:.02em}
p{line-height:1.6;max-width:65ch}
a{color:var(--link)}
img,canvas,svg{max-width:100%;display:block;border-radius:var(--radius);box-shadow:var(--shadow)}
::selection{background:var(--rust-50);color:var(--cream-05)}

/* ---------- HEADER ---------- */
header{position:fixed;top:0;left:0;width:100%;padding:.8rem 2rem;display:flex;justify-content:space-between;align-items:center;background:color-mix(in srgb,var(--soil-90) 80%,var(--sage-30));backdrop-filter:blur(4px);box-shadow:0 0 .6rem rgba(0,0,0,.7);z-index:1000}
header nav a{margin-left:1.2rem;text-decoration:none;font-weight:600;color:var(--cream-05);position:relative}
header nav a::after{content:"";position:absolute;inset:100% 0 0 0;height:2px;background:var(--accent);transform:scaleX(0);transform-origin:left;transition:transform .3s}
header nav a:hover::after{transform:scaleX(1)}
header .logo{font-weight:800;color:var(--accent);font-size:1.1rem;letter-spacing:.05em}

/* ---------- HERO ---------- */
#hero{display:grid;place-items:center;background:
        linear-gradient(120deg,var(--soil-80) 0%,var(--sage-30) 40%,var(--soil-80) 100%);
        animation:shift 20s linear infinite;background-size:400% 400%;
        min-height:100vh;text-align:center}
@keyframes shift{0%{background-position:0 0}100%{background-position:400% 0}}
#hero h1{font-size:clamp(2.5rem,6vw,5rem)}
.scrollCue{margin-top:4rem;width:2px;height:3rem;background:var(--cream-05);position:relative;overflow:hidden}
.scrollCue::before{content:"";position:absolute;top:-100%;left:0;right:0;height:100%;background:var(--accent);animation:scrollCue 2s infinite}
@keyframes scrollCue{0%{top:-100%}50%{top:0}100%{top:100%}}

/* ---------- REVEAL ---------- */
.reveal{opacity:0;transform:translateY(40px);transition:opacity .8s ease-out,transform .8s ease-out}
.reveal.visible{opacity:1;transform:none}

/* ---------- TIMELINE ---------- */
.timeline{display:grid;gap:2rem;margin-top:3rem}
.step{background:var(--soil-70);padding:2rem;border-left:4px solid var(--rust-30);border-radius:var(--radius);position:relative}
.step:before{content:"";position:absolute;left:-.8rem;top:1.2rem;width:.8rem;height:.8rem;border-radius:50%;background:var(--rust-30)}

/* ---------- GALLERY ---------- */
.gallery{display:grid;gap:2rem;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));margin-top:3rem}

/* ---------- BADGE ---------- */
.badge{display:inline-block;padding:.2em .7em;background:var(--rust-30);border-radius:9999px;font-size:.75rem;text-transform:uppercase;letter-spacing:.05em;color:var(--soil-90);font-weight:700;margin-right:.4rem}

/* ---------- FOOTER ---------- */
footer{padding:4rem 2rem;text-align:center;background:var(--soil-90);font-size:.85rem;color:var(--text-muted)}
</style>
</head>
<body>

<header>
  <div class="logo">Engine Δ</div>
  <nav>
    <a href="#story">Story</a>
    <a href="#arch">Architecture</a>
    <a href="#perf">Performance</a>
    <a href="#showcase">Showcase</a>
  </nav>
</header>

<!-- ---------- HERO ---------- -->
<section id="hero">
  <div>
    <h1>Building an Engine&nbsp;<br><small style="font-size:45%;font-weight:400;color:var(--text-muted)">from byte‑code to photons</small></h1>
    <p style="max-width:60ch;margin-inline:auto">A deep‑dive into my zero‑to‑one graphics & HPC playground: multi‑level parallelism, real‑time path tracing,<br>
      and more coffee than medically advisable.</p>
    <div class="scrollCue"></div>
  </div>
</section>

<!-- ---------- ORIGIN STORY ---------- -->
<section id="story">
  <h2 class="reveal">Genesis &nbsp;<span class="badge">7 Weeks</span></h2>
  <p class="reveal">Eager to prove I could own the *entire* stack—from SIMD kernels to responsive tooling—I set myself a constraint:  
  no external graphics middleware. **Everything**—scene graph, shader compiler, scheduling layer—written from scratch, and benchmarked using HPC best practices.</p>

  <div class="timeline reveal">
    <div class="step"><strong>M0 — Serial Prototype.</strong> A minimal PBR renderer proving the material system and frame graph design.</div>
    <div class="step"><strong>M1 — Threaded.</strong> Task‑stealing job system with NUMA‑aware arenas; 5.3× speed‑up on 16C/32T Ryzen.</div>
    <div class="step"><strong>M2 — GPU.</strong> <span class="badge">OpenCL</span> &nbsp;<span class="badge">Vulkan Compute</span> back‑ends; zero‑copy staging; bindless resource table.</div>
    <div class="step"><strong>M3 — Distributed.</strong> Domain‑decomposed light transport with <span class="badge">MPI</span> halo‑exchange of irradiance volumes.</div>
  </div>
</section>

<!-- ---------- ARCHITECTURE ---------- -->
<section id="arch">
  <h2 class="reveal">Architecture at&nbsp;a Glance</h2>
  <canvas id="archCanvas" width="800" height="400" class="reveal"></canvas>
  <p class="reveal">The canvas above animates the live task dependency DAG. Orange nodes = CPU passes, Sage nodes = GPU kernels, Sand nodes = I/O. Hover to pause.</p>
</section>

<!-- ---------- PERFORMANCE ---------- -->
<section id="perf">
  <h2 class="reveal">Performance Findings</h2>
  <svg id="roofline" viewBox="0 0 600 350" class="reveal" aria-label="Roofline chart"></svg>
  <p class="reveal">Achieving 85 % of theoretical DRAM bandwidth and 63 % of FP32 peak on an RTX 4070 required a careful balance of wavefront size, register pressure, and shared‑memory tiling.  
  Full analysis in <a href="#pdf" title="coming soon">Appendix&nbsp;A</a>.</p>
</section>

<!-- ---------- SHOWCASE ---------- -->
<section id="showcase">
  <h2 class="reveal">Visual Showcase</h2>
  <div class="gallery">
    <canvas class="shot" width="640" height="360"></canvas>
    <canvas class="shot" width="640" height="360"></canvas>
    <canvas class="shot" width="640" height="360"></canvas>
    <canvas class="shot" width="640" height="360"></canvas>
  </div>
</section>

<footer>
  &copy; 2025&nbsp;Δ Engine — Crafted with sage, sand &amp; silicon.
</footer>

<!-- ---------- JAVASCRIPT ---------- -->
<script>
/* ---------- SCROLL REVEAL ---------- */
const observer=new IntersectionObserver((e)=>e.forEach(el=>{
  if(el.isIntersecting){el.target.classList.add('visible');observer.unobserve(el.target);}
}),{threshold:.15});
document.querySelectorAll('.reveal').forEach(el=>observer.observe(el));

/* ---------- ARCHITECTURE DAG CANVAS ---------- */
(()=>{
  const cv=document.getElementById('archCanvas'),ctx=cv.getContext('2d');
  const W=cv.width,H=cv.height;
  const nodes=[...Array(16)].map((_,i)=>({
     x:Math.random()*W*.9+W*.05,
     y:Math.random()*H*.7+H*.15,
     type:i<6?'cpu':i<12?'gpu':'io'
  }));
  const edges=[...Array(26)].map(()=>[
    nodes[Math.floor(Math.random()*nodes.length)],
    nodes[Math.floor(Math.random()*nodes.length)]
  ]);
  const palette={cpu:'#a67c52',gpu:'#4e6e5d',io:'#d9cba0'};
  let run=true;
  cv.addEventListener('mouseenter',()=>run=false);
  cv.addEventListener('mouseleave',()=>run=true);
  function draw(t){
    if(!run)return;
    ctx.clearRect(0,0,W,H);
    ctx.lineWidth=1.5;ctx.globalAlpha=.8;
    edges.forEach(([a,b])=>{
      ctx.beginPath();ctx.moveTo(a.x,a.y);ctx.lineTo(b.x,b.y);
      ctx.strokeStyle='#333';ctx.stroke();
    });
    nodes.forEach(n=>{
      ctx.beginPath();ctx.arc(n.x,n.y,14,0,Math.PI*2);
      ctx.fillStyle=palette[n.type];
      ctx.fill();ctx.lineWidth=3;ctx.strokeStyle='rgba(0,0,0,.25)';ctx.stroke();
      // subtle float motion
      n.y+=Math.sin(t/800 + n.x)*.05;
    });
    requestAnimationFrame(draw);
  }requestAnimationFrame(draw);
})();

/* ---------- ROOFLINE SVG ---------- */
(function(){
 const svg=document.getElementById('roofline');
 const W=600,H=350,M=50,maxOP=800,maxBW=500;
 const ops=[50,200,600,750], ai=[1,3,8,12];
 // axes
 svg.innerHTML=`<g stroke="${getCSS('--text-muted')}" stroke-width="1">
   <line x1="${M}" y1="${H-M}" x2="${W-M}" y2="${H-M}"/>
   <line x1="${M}" y1="${H-M}" x2="${M}" y2="${M}"/>
 </g>`;
 // roofline arms
 const slope=maxBW, kneeX=maxOP/slope;
 const kx=M+ (kneeX)/(maxOP/maxBW)*(W-2*M), ky=H-M - kneeX*(H-2*M)/maxOP;
 svg.innerHTML+=`<path d="M ${M} ${H-M} L ${kx} ${ky} L ${W-M} ${ky}" fill="none" stroke="${getCSS('--accent')}" stroke-width="2"/>`;
 // points
 ops.forEach((flops,i)=>{
   const arithmetic=ai[i];
   const x=M+ (arithmetic/maxBW)*(W-2*M);
   const y=H-M - (flops/maxOP)*(H-2*M);
   svg.innerHTML+=`<circle cx="${x}" cy="${y}" r="6" fill="${getCSS('--rust-30')}" stroke="#000" stroke-width=".8"/>`;
 });
 // helpers
 function getCSS(v){return getComputedStyle(document.documentElement).getPropertyValue(v);}
})();

/* ---------- SHOTS CANVAS ---------- */
document.querySelectorAll('.shot').forEach((cv,i)=>{
  const ctx=cv.getContext('2d'),W=cv.width,H=cv.height;
  const grd=ctx.createLinearGradient(0,0,W,H);
  grd.addColorStop(0,getCSS('--soil-80'));grd.addColorStop(1,getCSS('--soil-70'));
  // render a fake path‑traced sphere + floor
  function render(){
    ctx.fillStyle=grd;ctx.fillRect(0,0,W,H);
    // floor
    ctx.fillStyle=getCSS('--sand-40');ctx.fillRect(0,H*0.65,W,H*0.35);
    // sphere
    const r=H*.25, cx=W*.5+Math.sin(Date.now()/6000+i)*W*.15, cy=H*.45;
    const radial=ctx.createRadialGradient(cx-r*.4,cy-r*.4,1,cx,cy,r);
    radial.addColorStop(0,'#ffffff');radial.addColorStop(.2,getCSS('--sage-30'));
    radial.addColorStop(1,getCSS('--soil-70'));
    ctx.beginPath();ctx.arc(cx,cy,r,0,Math.PI*2);ctx.fillStyle=radial;ctx.fill();
    requestAnimationFrame(render);
  }render();
  function getCSS(v){return getComputedStyle(document.documentElement).getPropertyValue(v);}
});
</script>
</body>
</html>
