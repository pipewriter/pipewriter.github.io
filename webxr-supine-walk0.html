
<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Supine Walking Simulator</title><style>body{margin:0;overflow:hidden;font-family:Arial;background:#000;color:#fff}</style></head><body><script type="module">import*as T from"https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.module.js";import{VRButton as B}from"https://cdn.jsdelivr.net/npm/three@0.158.0/examples/jsm/webxr/VRButton.js";import{XRControllerModelFactory as F}from"https://cdn.jsdelivr.net/npm/three@0.158.0/examples/jsm/webxr/XRControllerModelFactory.js";let scene=new T.Scene();scene.background=new T.Color(0x202844);let camera=new T.PerspectiveCamera(70,innerWidth/innerHeight,.1,1e3);let renderer=new T.WebGLRenderer({antialias:true});renderer.setPixelRatio(devicePixelRatio);renderer.setSize(innerWidth,innerHeight);renderer.xr.enabled=true;document.body.appendChild(renderer.domElement);document.body.appendChild(B.createButton(renderer));let player=new T.Group();player.add(camera);scene.add(player);scene.add(new T.HemisphereLight(0xffffff,0x444444,1));let d=new T.DirectionalLight(0xffffff,.5);d.position.set(1,1,1);scene.add(d);let g=new T.BoxGeometry(1,1,1);for(let i=0;i<200;i++){let m=new T.MeshStandardMaterial({color:0xffffff});m.color.setHSL(Math.random(),.7,.5);let b=new T.Mesh(g,m);b.scale.setScalar(Math.random()*3+.5);b.position.set((Math.random()-.5)*20,Math.random()*-100,(Math.random()-.5)*20);scene.add(b);}let factory=new F(),ctlL=renderer.xr.getController(0),ctlR=renderer.xr.getController(1);ctlL.add(factory.createControllerModel(ctlL));ctlR.add(factory.createControllerModel(ctlR));player.add(ctlL);player.add(ctlR);let clock=new T.Clock(),snap=false;function move(dt){let s=renderer.xr.getSession();if(!s)return;s.inputSources.forEach(src=>{if(!src.gamepad)return;let a=src.gamepad.axes,h=src.handedness;if(h==="right"){let x=a[2]||0,y=a[3]||0;if(Math.abs(x)+Math.abs(y)>.05){let up=new T.Vector3().setFromMatrixColumn(camera.matrixWorld,1).normalize(),right=new T.Vector3().crossVectors(up,new T.Vector3(0,1,0)).normalize();player.position.addScaledVector(up,-y*dt*2);player.position.addScaledVector(right,x*dt*2);}}else if(h==="left"){let lx=a[0]||0;if(Math.abs(lx)>.8&&!snap){player.rotateY(-Math.sign(lx)*Math.PI/6);snap=true;}if(Math.abs(lx)<.2)snap=false;}});}function render(){move(clock.getDelta());renderer.render(scene,camera);}renderer.setAnimationLoop(render);addEventListener("resize",()=>{camera.aspect=innerWidth/innerHeight;camera.updateProjectionMatrix();renderer.setSize(innerWidth,innerHeight);});</script></body></html>
