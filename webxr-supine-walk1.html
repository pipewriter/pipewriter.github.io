
<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Supine Walking Simulator</title><style>body{margin:0;overflow:hidden}</style></head><body><script type="module">import*as THREE from"https://cdn.jsdelivr.net/npm/three@0.161.0/build/three.module.js";import{VRButton}from"https://cdn.jsdelivr.net/npm/three@0.161.0/examples/jsm/webxr/VRButton.js";import{XRControllerModelFactory as F}from"https://cdn.jsdelivr.net/npm/three@0.161.0/examples/jsm/webxr/XRControllerModelFactory.js";const scene=new THREE.Scene;scene.background=new THREE.Color(0x202030);const cam=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,.1,1e3),ren=new THREE.WebGLRenderer({antialias:!0});ren.setPixelRatio(devicePixelRatio);ren.setSize(innerWidth,innerHeight);ren.xr.enabled=!0;document.body.appendChild(ren.domElement);document.body.appendChild(VRButton.createButton(ren));const floor=new THREE.Mesh(new THREE.PlaneGeometry(200,200,100,100),new THREE.MeshStandardMaterial({color:0x228822,wireframe:!0}));floor.rotation.x=-Math.PI/2;scene.add(floor);scene.add(new THREE.HemisphereLight(16777215,0x444444,1.2));for(let i=0;i<200;i++){const g=Math.random()<.5?new THREE.BoxGeometry(1,1,1):new THREE.SphereGeometry(.5,16,16),m=new THREE.MeshStandardMaterial({color:Math.random()*16777215}),o=new THREE.Mesh(g,m);o.position.set((Math.random()-.5)*100,.5,(Math.random()-.5)*100);scene.add(o)}const player=new THREE.Group;player.add(cam);scene.add(player);cam.rotation.x=-Math.PI/2;const ctrlL=ren.xr.getController(0),ctrlR=ren.xr.getController(1);player.add(ctrlL);player.add(ctrlR);const fac=new F,gripL=ren.xr.getControllerGrip(0);gripL.add(fac.createControllerModel(gripL));player.add(gripL);const gripR=ren.xr.getControllerGrip(1);gripR.add(fac.createControllerModel(gripR));player.add(gripR);let turnCool=0,turnDelay=.25;const clock=new THREE.Clock;function loop(_,frame){if(frame){const ses=ren.xr.getSession();for(const src of ses.inputSources){if(!src.gamepad)continue;const a=src.gamepad.axes;if(src.handedness==="right"){const mx=a[2]||0,my=a[3]||0,speed=.05,dir=new THREE.Vector3;cam.getWorldDirection(dir);const up=new THREE.Vector3(0,1,0).applyQuaternion(cam.quaternion),right=new THREE.Vector3().crossVectors(up,dir).normalize(),move=new THREE.Vector3;move.addScaledVector(up,-my*speed);move.addScaledVector(right,mx*speed);player.position.add(move)}else if(src.handedness==="left"){const lx=a[2]||a[0]||0;if(Math.abs(lx)>.8&&turnCool<=0){player.rotateOnWorldAxis(new THREE.Vector3(0,1,0),(lx>0?-1:1)*Math.PI/4);turnCool=turnDelay}}}if(turnCool>0)turnCool-=clock.getDelta()}ren.render(scene,cam)}ren.setAnimationLoop(loop);addEventListener("resize",()=>{cam.aspect=innerWidth/innerHeight;cam.updateProjectionMatrix();ren.setSize(innerWidth,innerHeight)});</script></body></html>
