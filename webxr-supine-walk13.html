<html><head><meta charset="utf-8"><title>Supine Walking Simulator</title><style>body{margin:0;overflow:hidden}</style></head><body><script type="module">import*as THREE from'https://cdn.jsdelivr.net/npm/three@0.161.0/build/three.module.js';import{VRButton}from'https://cdn.jsdelivr.net/npm/three@0.161.0/examples/jsm/webxr/VRButton.js';const scene=new THREE.Scene(),camera=new THREE.PerspectiveCamera(70,innerWidth/innerHeight,.01,1e3),renderer=new THREE.WebGLRenderer({antialias:!0});renderer.setPixelRatio(devicePixelRatio);renderer.setSize(innerWidth,innerHeight);renderer.xr.enabled=!0;document.body.appendChild(renderer.domElement);document.body.appendChild(VRButton.createButton(renderer));const player=new THREE.Group();player.add(camera);scene.add(player);scene.add(new THREE.HemisphereLight(16777215,4473924));const floorGeo=new THREE.PlaneGeometry(1e3,1e3,100,100);floorGeo.rotateX(-Math.PI/2);scene.add(new THREE.Mesh(floorGeo,new THREE.MeshStandardMaterial({color:2263618,wireframe:!0})));for(let i=0;i<200;i++){const b=new THREE.Mesh(new THREE.BoxGeometry(Math.random()*2+.5,Math.random()*2+.5,Math.random()*2+.5),new THREE.MeshStandardMaterial({color:Math.random()*16777215}));b.position.set((Math.random()-.5)*50,Math.random()*5+.5,(Math.random()-.5)*50);scene.add(b);}const controllers={},buildController=i=>{const c=renderer.xr.getController(i);c.addEventListener('connected',e=>{controllers[e.data.handedness]=c});c.addEventListener('disconnected',()=>{for(const h in controllers)controllers[h]===c&&delete controllers[h]});player.add(c)};buildController(0);buildController(1);let turnCooldown=0;renderer.setAnimationLoop(()=>{const right=controllers.right?.gamepad,left=controllers.left?.gamepad,spd=.05;if(right){const[rx,ry]=right.axes,up=new THREE.Vector3;camera.matrixWorld.extractBasis(new THREE.Vector3,up,new THREE.Vector3);player.position.addScaledVector(up,-(ry||0)*spd);const side=new THREE.Vector3(up.z,0,-up.x).normalize();player.position.addScaledVector(side,(rx||0)*spd);}if(left){const[lx]=left.axes,thr=.8,now=performance.now();if(Math.abs(lx)>thr&&now>turnCooldown){player.rotateOnWorldAxis(new THREE.Vector3(0,1,0),(lx>0?-1:1)*Math.PI/6);turnCooldown=now+300;}}renderer.render(scene,camera)});addEventListener('resize',()=>{camera.aspect=innerWidth/innerHeight;camera.updateProjectionMatrix();renderer.setSize(innerWidth,innerHeight)});</script></body></html>