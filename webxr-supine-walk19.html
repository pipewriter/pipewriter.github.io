<html><head><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"/><title>Supine Walking Simulator</title><style>body{margin:0;overflow:hidden}</style></head><body><script type="module">import * as THREE from"https://cdn.skypack.dev/three@0.160.0";import{XRButton}from"https://cdn.skypack.dev/three@0.160.0/examples/jsm/webxr/XRButton.js";const scene=new THREE.Scene(),camera=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,.1,1e3),renderer=new THREE.WebGLRenderer({antialias:!0});renderer.setSize(innerWidth,innerHeight);renderer.xr.enabled=!0;document.body.appendChild(renderer.domElement);document.body.appendChild(XRButton.createButton(renderer));const rig=new THREE.Group();rig.add(camera);scene.add(rig);scene.background=new THREE.Color(0x88ccee);scene.add(new THREE.HemisphereLight(0xffffff,0x444444));scene.add(new THREE.Mesh(new THREE.PlaneGeometry(200,200).rotateX(-Math.PI/2),new THREE.MeshPhongMaterial({color:0x228822})));for(let i=0;i<200;i++){const b=new THREE.Mesh(new THREE.BoxGeometry(1,1,1),new THREE.MeshStandardMaterial({color:Math.random()*0xffffff}));b.position.set((Math.random()-.5)*100,.5,(Math.random()-.5)*100);scene.add(b);}const speed=.1,snap=Math.PI/6,dead=.3;let last=0;function headUp(){const m=new THREE.Matrix4();m.extractRotation(camera.matrixWorld);return new THREE.Vector3(0,1,0).applyMatrix4(m).normalize()}renderer.setAnimationLoop(()=>{const s=renderer.xr.getSession();if(s)for(const src of s.inputSources)if(src&&src.gamepad){const a=src.gamepad.axes,h=src.handedness;if(h==="right"){const x=a[2]!==undefined?a[2]:a[0],y=a[3]!==undefined?a[3]:a[1];Math.abs(y)>dead&&rig.position.add(headUp().multiplyScalar(-y*speed));if(Math.abs(x)>dead){const side=headUp().clone().cross(camera.getWorldDirection(new THREE.Vector3())).normalize();rig.position.add(side.multiplyScalar(x*speed));}}else if(h==="left"){const x=a[2]!==undefined?a[2]:a[0];Math.abs(x)>.7&&performance.now()-last>300&&(rig.rotation.y-=Math.sign(x)*snap,last=performance.now());}}renderer.render(scene,camera)});addEventListener("resize",()=>{camera.aspect=innerWidth/innerHeight;camera.updateProjectionMatrix();renderer.setSize(innerWidth,innerHeight)});</script></body></html>