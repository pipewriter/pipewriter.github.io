<html><head><meta charset="utf-8"><title>Supine Walking Simulator</title><style>body{margin:0;overflow:hidden}</style></head><body><script type="module">import*as THREE from"https://cdn.jsdelivr.net/npm/three@0.159/build/three.module.js";import{VRButton}from"https://cdn.jsdelivr.net/npm/three@0.159/examples/jsm/webxr/VRButton.js";const scene=new THREE.Scene(),camera=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,.1,1e3),renderer=new THREE.WebGLRenderer({antialias:!0});renderer.setSize(innerWidth,innerHeight);renderer.xr.enabled=!0;document.body.appendChild(renderer.domElement);document.body.appendChild(VRButton.createButton(renderer));const player=new THREE.Group;player.add(camera);scene.add(player);scene.add(new THREE.HemisphereLight(16777215,4466542,1));const ground=new THREE.Mesh(new THREE.PlaneGeometry(1e3,1e3,10,10),new THREE.MeshPhongMaterial({color:0x228b22,side:THREE.DoubleSide}));ground.rotateX(-Math.PI/2);scene.add(ground);for(let i=0;i<100;i++){const h=1+5*Math.random(),box=new THREE.Mesh(new THREE.BoxGeometry(2,h,2),new THREE.MeshStandardMaterial({color:16777215*Math.random()}));box.position.set(50*(Math.random()-.5),h/2,-200*Math.random());scene.add(box);}camera.position.set(0,1.6,0);let turnCooldown=0,turnDelay=300,turnAngle=Math.PI/4;function handleControllers(dt){const s=renderer.xr.getSession();if(!s)return;s.inputSources.forEach(src=>{if(!src.gamepad)return;const g=src.gamepad,left="left"===src.handedness,ax=g.axes;if(!left&&ax.length>=4){const fy=-ax[3],fx=ax[2];if(Math.abs(fy)>.05||Math.abs(fx)>.05){const up=new THREE.Vector3(0,1,0).applyQuaternion(camera.quaternion).normalize(),right=new THREE.Vector3(1,0,0).applyQuaternion(camera.quaternion).normalize();player.position.add(up.multiplyScalar(2*fy*dt));player.position.add(right.multiplyScalar(2*fx*dt));}}if(left&&ax.length>=2){const lx=ax[0];if(turnCooldown<=0){if(lx>.8){player.rotation.z-=turnAngle;turnCooldown=turnDelay;}else if(lx<-.8){player.rotation.z+=turnAngle;turnCooldown=turnDelay;}}}});if(turnCooldown>0)turnCooldown-=1e3*dt;}const clock=new THREE.Clock;renderer.setAnimationLoop(()=>{const dt=clock.getDelta();handleControllers(dt);renderer.render(scene,camera);});window.addEventListener("resize",()=>{camera.aspect=innerWidth/innerHeight;camera.updateProjectionMatrix();renderer.setSize(innerWidth,innerHeight);});</script></body></html>