
<html><head><meta charset="utf-8"><title>Supine Walking Simulator</title><style>body{margin:0;overflow:hidden}</style></head><body><script type="module">import*as THREE from"https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js";import{VRButton}from"https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/webxr/VRButton.js";let s=new THREE.Scene;s.background=new THREE.Color(0x202020);let c=new THREE.PerspectiveCamera(70,innerWidth/innerHeight,.1,1e3),r=new THREE.WebGLRenderer({antialias:!0});r.setSize(innerWidth,innerHeight);r.xr.enabled=!0;document.body.append(r.domElement,VRButton.createButton(r));let g=new THREE.Group;g.add(c);s.add(g,new THREE.HemisphereLight(16777215,4473924,1));let pg=new THREE.PlaneGeometry(1e3,1e3,50,50);pg.rotateX(-Math.PI/2);s.add(new THREE.Mesh(pg,new THREE.MeshStandardMaterial({color:0x228822,wireframe:!0})));for(let i=0;i<200;i++){let b=new THREE.Mesh(new THREE.BoxGeometry(1,1,1),new THREE.MeshStandardMaterial({color:Math.random()*16777215}));b.position.set((Math.random()-.5)*50,.5,(Math.random()-.5)*50);s.add(b)}let con=[],gpF=null,gpT=null,turnReady=!0;function sc(i){let h=r.xr.getController(i);h.addEventListener("connected",e=>{let gp=e.data.gamepad;"right"===e.data.handedness?gpF=gp:gpT=gp}),h.addEventListener("disconnected",()=>{h===con[0]&&(gpF=null),h===con[1]&&(gpT=null)}),s.add(h),con.push(h)}sc(0),sc(1);let clk=new THREE.Clock;r.setAnimationLoop(()=>{let dt=clk.getDelta();if(gpF&&gpF.axes.length>3){let vy=-gpF.axes[3];if(Math.abs(vy)>.1){let dir=new THREE.Vector3(0,1,0).applyQuaternion(c.quaternion).setY(0).normalize();g.position.addScaledVector(dir,3*vy*dt)}}if(gpT&&gpT.axes.length>2){let vx=gpT.axes[2];turnReady&&Math.abs(vx)>.8?(g.rotateY((vx>0?-1:1)*Math.PI/6),turnReady=!1):Math.abs(vx)<.2&&(turnReady=!0)}r.render(s,c)}),addEventListener("resize",()=>{c.aspect=innerWidth/innerHeight,c.updateProjectionMatrix(),r.setSize(innerWidth,innerHeight)})</script></body></html>
