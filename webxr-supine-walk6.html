
<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Supine Walking Simulator</title><style>body{margin:0;overflow:hidden}</style></head><body><script type="module">import * as THREE from "https://unpkg.com/three@0.159.0/build/three.module.js";import {VRButton} from "https://unpkg.com/three@0.159.0/examples/jsm/webxr/VRButton.js";const scene=new THREE.Scene(),clock=new THREE.Clock(),renderer=new THREE.WebGLRenderer({antialias:!0});renderer.setPixelRatio(devicePixelRatio);renderer.setSize(innerWidth,innerHeight);renderer.xr.enabled=!0;document.body.appendChild(renderer.domElement);document.body.appendChild(VRButton.createButton(renderer));const camera=new THREE.PerspectiveCamera(70,innerWidth/innerHeight,.1,1e3),rig=new THREE.Group();rig.add(camera);scene.add(rig);scene.add(new THREE.HemisphereLight(16777215,4473924,1));const ground=new THREE.Mesh(new THREE.PlaneGeometry(1e3,1e3),new THREE.MeshStandardMaterial({color:2248258}));ground.rotation.x=-Math.PI/2;scene.add(ground);for(let i=0;i<200;i++){const m=new THREE.Mesh(new THREE.BoxGeometry(1,1,1),new THREE.MeshStandardMaterial({color:Math.random()*16777215}));m.position.set((Math.random()-.5)*50,.5,(Math.random()-.5)*50);scene.add(m)}const up=new THREE.Vector3(0,1,0);function fwd(){const v=new THREE.Vector3(0,1,0);return v.applyQuaternion(camera.quaternion),v.y=0,v.normalize()}let lastTurn=0;function loop(t){const dt=clock.getDelta(),s=renderer.xr.getSession();if(s){let r=null,l=null;for(const src of s.inputSources)src.gamepad&&("right"===src.handedness?r=src.gamepad.axes:"left"===src.handedness&&(l=src.gamepad.axes));if(r){const fv=fwd(),rv=new THREE.Vector3().crossVectors(up,fv).normalize();rig.position.addScaledVector(fv,-r[3]*3*dt);rig.position.addScaledVector(rv,r[2]*3*dt)}if(l){const x=l[0];Math.abs(x)>.7&&t-lastTurn>300&&(rig.rotation.y+=-Math.sign(x)*Math.PI/6,lastTurn=t)}}renderer.render(scene,camera)}renderer.setAnimationLoop(loop);addEventListener("resize",()=>{camera.aspect=innerWidth/innerHeight,camera.updateProjectionMatrix(),renderer.setSize(innerWidth,innerHeight)})</script></body></html>
