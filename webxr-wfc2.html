<!DOCTYPE html><html><head><meta charset="utf-8"><title>WFC WebXR</title><style>body{margin:0;overflow:hidden}canvas{display:block}</style></head><body><script type="module">import*as THREE from"https://cdn.jsdelivr.net/npm/three@0.161.0/build/three.module.js";import{VRButton}from"https://cdn.jsdelivr.net/npm/three@0.161.0/examples/jsm/webxr/VRButton.js";const scene=new THREE.Scene(),size=10,tiles=7,adj=[];for(let i=0;i<tiles;i++){adj[i]=[];for(let j=0;j<tiles;j++)adj[i][j]=j===i||j===(i+1)%tiles||j===(i+tiles-1)%tiles;}const grid=[];for(let y=0;y<size;y++){grid[y]=[];for(let x=0;x<size;x++)grid[y][x]={opts:[...Array(tiles).keys()]};}function collapse(){let m=tiles+1,c=[];for(let y=0;y<size;y++)for(let x=0;x<size;x++){const o=grid[y][x].opts.length;if(o>1&&o<m){m=o;c=[{x,y}]}else if(o===m)c.push({x,y});}if(!c.length)return!1;const{x,y}=c[Math.random()*c.length|0],cell=grid[y][x];cell.opts=[cell.opts[Math.random()*cell.opts.length|0]];prop([{x,y}]);return!0;}function prop(q){while(q.length){const{x,y}=q.pop(),o=grid[y][x].opts;[[1,0],[-1,0],[0,1],[0,-1]].forEach(([dx,dy])=>{const nx=x+dx,ny=y+dy;if(nx<0||ny<0||nx>=size||ny>=size)return;const n=grid[ny][nx],b=n.opts.length;n.opts=n.opts.filter(t2=>o.some(t1=>adj[t1][t2]));if(!n.opts.length)n.opts=[Math.random()*tiles|0];if(n.opts.length!==b)q.push({x:nx,y:ny});});}}while(collapse());const cols=[0xff0000,0xff7f00,0xffff00,0x00ff00,0x0000ff,0x4b0082,0x9400d3],geo=new THREE.BoxGeometry(.9,.2,.9);for(let y=0;y<size;y++)for(let x=0;x<size;x++){const t=grid[y][x].opts[0],mat=new THREE.MeshStandardMaterial({color:cols[t]}),mesh=new THREE.Mesh(geo,mat);mesh.position.set(x-size/2+.5,0,y-size/2+.5);scene.add(mesh);}scene.add(new THREE.DirectionalLight(0xffffff,1).position.set(1,2,3));scene.add(new THREE.AmbientLight(0x404040));const cam=new THREE.PerspectiveCamera(70,innerWidth/innerHeight,.1,100);cam.position.set(0,5,0);cam.lookAt(0,0,0);const r=new THREE.WebGLRenderer({antialias:!0});r.setSize(innerWidth,innerHeight);r.xr.enabled=!0;document.body.appendChild(r.domElement);document.body.appendChild(VRButton.createButton(r));addEventListener("resize",()=>{cam.aspect=innerWidth/innerHeight;cam.updateProjectionMatrix();r.setSize(innerWidth,innerHeight);});r.setAnimationLoop(()=>r.render(scene,cam));</script></body></html>