<html><head><meta charset="utf-8"><style>body{margin:0;overflow:hidden}</style></head><body><script type="module">import*as T from'https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js';import{VRButton as V}from'https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/webxr/VRButton.js';const s=new T.Scene(),c=new T.PerspectiveCamera(60,innerWidth/innerHeight,.1,1e3);c.position.set(0,30,0);c.lookAt(0,0,0);const r=new T.WebGLRenderer({antialias:1});r.setSize(innerWidth,innerHeight);r.xr.enabled=1;document.body.appendChild(r.domElement);document.body.appendChild(V.createButton(r));addEventListener('resize',()=>{c.aspect=innerWidth/innerHeight;c.updateProjectionMatrix();r.setSize(innerWidth,innerHeight)});s.add(new T.AmbientLight(0xffffff,.6));const d=new T.DirectionalLight(0xffffff,.6);d.position.set(1,1,1);s.add(d);const N=10,S=1,cols=[0xff004c,0x00eaff,0xeaff00,0xff00ff,0x00ff2a,0xff7f00,0xffffff];let g=[...Array(N)].map(()=>[...Array(N)].map(()=>[0,1,2,3,4,5,6]));const nbr=[[1,0],[-1,0],[0,1],[0,-1]];function prop(q){for(;q.length;){const{x,y}=q.pop(),col=g[x][y][0];for(const[dx,dy]of nbr){const nx=x+dx,ny=y+dy;if(nx<0||ny<0||nx>=N||ny>=N)continue;const cell=g[nx][ny];if(cell.length>1){const i=cell.indexOf(col);if(i>-1){cell.splice(i,1);if(cell.length==1)q.push({x:nx,y:ny});}}}}}function collapse(){for(;;){let m=8,mx=-1,my=-1;for(let i=0;i<N;i++)for(let j=0;j<N;j++){const l=g[i][j].length;if(l>1&&l<m){m=l;mx=i;my=j;}}if(mx==-1)break;const cell=g[mx][my];g[mx][my]=[cell[Math.random()*cell.length|0]];prop([{x:mx,y:my}]);}}collapse();const geo=new T.BoxGeometry(S,.5,S);for(let i=0;i<N;i++)for(let j=0;j<N;j++){const mat=new T.MeshStandardMaterial({color:cols[g[i][j][0]]});const cube=new T.Mesh(geo,mat);cube.position.set((i-N/2)*S,0,(j-N/2)*S);s.add(cube);}s.add(new T.GridHelper(N*S,N));r.setAnimationLoop(()=>r.render(s,c));</script></body></html>