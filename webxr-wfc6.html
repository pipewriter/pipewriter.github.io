<html><head><meta charset="utf-8"><style>body{margin:0;overflow:hidden}</style></head><body><script type="module">import* as THREE from'https://cdn.jsdelivr.net/npm/three@0.160/build/three.module.js';import{VRButton}from'https://cdn.jsdelivr.net/npm/three@0.160/examples/jsm/webxr/VRButton.js';const S=20,scene=new THREE.Scene();scene.background=new THREE.Color(0);const cam=new THREE.PerspectiveCamera(70,innerWidth/innerHeight,.1,1e3);cam.position.set(S/2,30,S/2);cam.lookAt(S/2,0,S/2);const ren=new THREE.WebGLRenderer({antialias:1});ren.setSize(innerWidth,innerHeight);ren.xr.enabled=1;document.body.appendChild(ren.domElement);document.body.appendChild(VRButton.createButton(ren));addEventListener('resize',()=>{cam.aspect=innerWidth/innerHeight;cam.updateProjectionMatrix();ren.setSize(innerWidth,innerHeight)});const colors=[0xff0000,0x00ff00,0x0000ff,0xffff00,0xff00ff,0x00ffff,0xffffff],geom=new THREE.BoxGeometry(1,1,1),grid=[];for(let x=0;x<S;x++){grid[x]=[];for(let y=0;y<S;y++)grid[x][y]={o:[0,1,2,3,4,5,6],c:0}}const neigh=(x,y)=>[[x-1,y],[x+1,y],[x,y-1],[x,y+1]].filter(p=>p[0]>=0&&p[0]<S&&p[1]>=0&&p[1]<S);function collapse(){let cells=[];for(let x=0;x<S;x++)for(let y=0;y<S;y++){let g=grid[x][y];g.c||cells.push({x,y,o:g.o})}cells.sort((a,b)=>a.o.length-b.o.length);if(!cells.length)return 1;let cell=cells[0],choice=cell.o[Math.random()*cell.o.length|0],g=grid[cell.x][cell.y];g.c=1;g.i=choice;for(let n of neigh(cell.x,cell.y)){let nb=grid[n[0]][n[1]];nb.c||(nb.o=nb.o.filter(v=>v!==choice),nb.o.length||(nb.o=[0,1,2,3,4,5,6]))}return 0}while(!collapse());for(let x=0;x<S;x++)for(let y=0;y<S;y++){let id=grid[x][y].i,mat=new THREE.MeshStandardMaterial({color:colors[id]}),mesh=new THREE.Mesh(geom,mat);mesh.position.set(x+.5,.5,y+.5);scene.add(mesh)}scene.add(new THREE.DirectionalLight(0xffffff,1).position.set(1,2,3));scene.add(new THREE.AmbientLight(0x404040));ren.setAnimationLoop(()=>ren.render(scene,cam));</script></body></html>