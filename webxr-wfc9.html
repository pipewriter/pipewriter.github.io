<html><head><meta charset="utf-8"><title>WebXR WFC Grid</title><style>body{margin:0;overflow:hidden}</style></head><body></body><script type="module">import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js';import {VRButton} from 'https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/webxr/VRButton.js';const scene=new THREE.Scene();const camera=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,0.1,1000);camera.position.set(0,20,0);camera.lookAt(0,0,0);const renderer=new THREE.WebGLRenderer({antialias:true});renderer.setPixelRatio(window.devicePixelRatio);renderer.setSize(window.innerWidth,window.innerHeight);renderer.xr.enabled=true;document.body.appendChild(renderer.domElement);document.body.appendChild(VRButton.createButton(renderer));window.addEventListener('resize',()=>{camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix();renderer.setSize(window.innerWidth,window.innerHeight);});const gridSize=10,cellSize=1,tiles=[0,1,2,3,4,5,6],colors=[0xff4444,0x44ff44,0x4444ff,0xffff44,0xff44ff,0x44ffff,0xffffff],adjacency={0:[1,2,3,4,5,6],1:[0,2,3,4,5,6],2:[0,1,3,4,5,6],3:[0,1,2,4,5,6],4:[0,1,2,3,5,6],5:[0,1,2,3,4,6],6:[0,1,2,3,4,5]},grid=[];for(let y=0;y<gridSize;y++){grid[y]=[];for(let x=0;x<gridSize;x++)grid[y][x]={options:[...tiles]}}function collapse(){let m=1/0,p=null;for(let y=0;y<gridSize;y++)for(let x=0;x<gridSize;x++){const c=grid[y][x];c.final===void 0&&c.options.length<m&&(m=c.options.length,p={x,y})}if(!p)return!0;const c=grid[p.y][p.x],choice=c.options[Math.random()*c.options.length|0];c.final=choice,c.options=[choice],propagate(p.x,p.y);return!1}function propagate(x,y){[[0,1],[1,0],[0,-1],[-1,0]].forEach(d=>{const nx=x+d[0],ny=y+d[1];if(nx<0||ny<0||nx>=gridSize||ny>=gridSize)return;const n=grid[ny][nx];n.final!==void 0||(n.options=n.options.filter(t=>adjacency[grid[y][x].final].includes(t)),n.options.length===1?(n.final=n.options[0],propagate(nx,ny)):n.options.length===0&&(n.options=[...tiles]))})}for(;!collapse();){}for(let y=0;y<gridSize;y++)for(let x=0;x<gridSize;x++){const type=grid[y][x].final,mesh=new THREE.Mesh(new THREE.BoxGeometry(.9,.2,.9),new THREE.MeshStandardMaterial({color:colors[type]}));mesh.position.set((x-gridSize/2+.5)*cellSize,0,(y-gridSize/2+.5)*cellSize),scene.add(mesh)}scene.add(new THREE.HemisphereLight(0xffffff,0x444444,1));renderer.setAnimationLoop(()=>{renderer.render(scene,camera)});</script></html>